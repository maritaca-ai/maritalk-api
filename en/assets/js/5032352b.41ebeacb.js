"use strict";(self.webpackChunkmaritaca=self.webpackChunkmaritaca||[]).push([[8875],{7055:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=t(4848),i=t(8453);const r={id:"files",title:"File Inputs"},l=void 0,o={id:"en/files",title:"File Inputs",description:"Our API supports uploading files directly through the Chat Completions endpoint.",source:"@site/docs/en/files_in_completions_api_en.md",sourceDirName:"en",slug:"/en/files",permalink:"/en/en/files",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"files",title:"File Inputs"},sidebar:"sidebarEn",previous:{title:"Batch API",permalink:"/en/en/batch-api"},next:{title:"LangChain",permalink:"/en/en/examples/langchain"}},a={},c=[{value:"Extraction effort",id:"extraction-effort",level:2},{value:"Available extraction levels",id:"available-extraction-levels",level:3},{value:"Example using extraction effort",id:"example-using-extraction-effort",level:3},{value:"Important Considerations",id:"important-considerations",level:2},{value:"Other examples",id:"other-examples",level:2},{value:"Multiple documents of different types",id:"multiple-documents-of-different-types",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Our API supports uploading files directly through the Chat Completions endpoint.\nAt the moment, files must be sent ",(0,s.jsx)(n.strong,{children:"in Base64 format"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Below is an example illustrating how to upload a PDF to the API:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import base64\nimport openai\n\nclient = openai.OpenAI(\n    api_key="YOUR_KEY",\n    base_url="https://chat.maritaca.ai/api",\n)\n\nwith open("my_research_proposal.pdf", "rb") as f:\n    file_content = f.read()\n    file_content_base64 = base64.b64encode(file_content).decode("utf-8")\n\nmessages = [\n    {\n        "role": "user",\n        "content": [\n            {\n                "type": "file",\n                "file": {\n                    "filename": "my_research.pdf",\n                    "file_data": f"data:application/pdf;base64,{file_content_base64}",\n                },\n            },\n            {\n                "type": "text",\n                "text": "What is the title of the research proposed here?",\n            },\n        ],\n    }\n]\n\nresponse = client.chat.completions.create(\n    model="sabia-3.1",\n    messages=messages,\n)\n'})}),"\n",(0,s.jsx)(n.p,{children:"When you submit files, the API extracts the text content and feeds it to the model.\nAll extracted content is returned in the response and can be accessed like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'extracted_docs = response.extracted_content\n\nfor doc in extracted_docs:\n    print(doc["filename"])  # File name\n    print(doc["text"])      # Extracted text\n'})}),"\n",(0,s.jsx)(n.p,{children:"We currently support the following file types:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PDF"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"DOCX"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"TXT"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"CSV"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"XML"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"XLSX"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"MD"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"extraction-effort",children:"Extraction effort"}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.strong,{children:"PDF files"}),", you can specify the extraction effort level.\nThis setting currently has ",(0,s.jsx)(n.strong,{children:"no effect"})," on other file types."]}),"\n",(0,s.jsxs)(n.p,{children:["If not specified, the default extraction level is ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"medium"})}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"available-extraction-levels",children:"Available extraction levels"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Level"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Cost per page of PDF"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"basic"})}),(0,s.jsx)(n.td,{children:"Lowest-effort extraction. Limited handling of images/tables."}),(0,s.jsx)(n.td,{children:"Free"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"medium"})}),(0,s.jsx)(n.td,{children:"Balanced extraction. Works best for most PDFs."}),(0,s.jsx)(n.td,{children:"R$ 0,02"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"advanced"})}),(0,s.jsx)(n.td,{children:"Highest-quality extraction for complex layouts, formulas, or diagrams."}),(0,s.jsx)(n.td,{children:"R$ 0,045"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["You can check the extraction pricing on our ",(0,s.jsx)(n.a,{href:"https://plataforma.maritaca.ai/modelos",children:"platform"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"example-using-extraction-effort",children:"Example using extraction effort"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'response = client.chat.completions.create(\n    model="sabia-3.1",\n    messages=messages,\n    extra_body={\n        "extraction_effort": "basic"\n    },\n)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"usage"})," field includes both token usage and the number of extracted PDF pages:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'usage = response.usage\nprint(usage)\n\n# CompletionUsage(\n#     completion_tokens=167,\n#     prompt_tokens=45,\n#     total_tokens=212,\n#     extraction_details={\n#         "medium_effort_pages_extracted": 1,\n#         "advanced_effort_pages_extracted": 0,\n#     },\n# )\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"important-considerations",children:"Important Considerations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Extracted text is not stored by the API."}),"\nIf you plan to ask follow-up questions about the same file, store the extracted text yourself \u2014 otherwise, a new request will trigger extraction (and trigger extraction charges for medium/advanced PDFs)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"The combined size of all files in a request must be under 50 MB."})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["PDFs extracted using ",(0,s.jsx)(n.code,{children:"medium"})," or ",(0,s.jsx)(n.code,{children:"advanced"})," effort incur extraction charges"]}),", in addition to the prompt tokens processed by the model."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Discounts"})," Off-peak and Batch API discounts apply only to input and output tokens. ",(0,s.jsx)(n.em,{children:"These discounts do not apply to the extraction cost."})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"other-examples",children:"Other examples"}),"\n",(0,s.jsx)(n.h3,{id:"multiple-documents-of-different-types",children:"Multiple documents of different types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'xml_path = "test.xml"\ncsv_path = "test.csv"\npdf_path = "test.pdf"\n\nwith open(xml_path, "rb") as xml_file:\n    xml_content = xml_file.read()\n    xml_content = base64.b64encode(xml_content).decode("utf-8")\n\nwith open(csv_path, "rb") as csv_file:\n    csv_content = csv_file.read()\n    csv_content = base64.b64encode(csv_content).decode("utf-8")\n\nwith open(pdf_path, "rb") as pdf_file:\n    pdf_content = pdf_file.read()\n    pdf_content = base64.b64encode(pdf_content).decode("utf-8")\n\ncsv_segment = {\n    "type": "file",\n    "file": {\n        "filename": "test.csv",\n        "file_data": f"data:text/csv;base64,{csv_content}",\n    },\n}\n\nxml_segment = {\n    "type": "file",\n    "file": {\n        "filename": "test.xml",\n        "file_data": f"data:application/xml;base64,{xml_content}",\n    },\n}\n\npdf_segment = {\n    "type": "file",\n    "file": {\n        "filename": "test.pdf",\n        "file_data": f"data:application/pdf;base64,{pdf_content}",\n    },\n}\n\nmessages = [\n    {\n        "role": "system",\n        "content": "You are a helpful assistant that can extract information from files",\n    },\n    {\n        "role": "user",\n        "content": [\n            csv_segment,\n            xml_segment,\n            pdf_segment,\n            {"type": "text", "text": "What is the content of each of these files?"},\n        ],\n    },\n]\n\nr = client.chat.completions.create(\n    model=model_name,\n    messages=messages,\n    max_tokens=30,\n    extra_body={\n        "extraction_effort": "basic",\n    },\n)\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var s=t(6540);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);